<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <link rel="icon" href="/favicon-32.png" type="image/png" sizes="32x32">

    <meta charset="UTF-8">
    <link rel="stylesheet" href="common.css">
  <link rel="stylesheet" href="components.css">
  <title data-i18n="qiuanjian.title">求案件</title>
</head>
<body>
    <div class="page page-wide c-stack match-page">
        <div class="c-page-head-grid">
            <div class="c-page-head-spacer" aria-hidden="true"></div>
            <div class="c-switch-wrap order-page">
                <div class="c-switcher-group" role="tablist" aria-label="模式切换">
                    <button class="c-toggle is-active" type="button" role="tab" aria-selected="true" data-view="people">有人</button>
                    <button class="c-toggle" type="button" role="tab" aria-selected="false" data-view="cases">有案件</button>
                </div>
            </div>
            <div class="c-page-head-spacer" aria-hidden="true"></div>
        </div>

        <div class="content-grid">
        <div>
        <section class="c-card c-card-pad match-view" data-view="people">
            <h2 class="title c-panel-title">技术者信息</h2>
            <div class="form-grid form-grid-spaced">
                <div class="form-field">
                    <label for="nation">国籍</label>
                    <select id="nation">
                        <option value="">请选择</option>
                        <option value="中国">中国</option>
                        <option value="日本">日本</option>
                    </select>
                </div>
                <div class="form-field">
                    <label for="age">年龄</label>
                    <input id="age" type="number" placeholder="例如：32">
                </div>
                <div class="form-field full">
                    <label for="price">金额</label>
                    <input id="price" type="text" placeholder="例如：￥50,000">
                </div>
                <div class="form-field full">
                    <label for="intro">介绍文</label>
                    <textarea id="intro" rows="10" placeholder="请输入人员介绍、技能或补充说明。"></textarea>
                </div>
            </div>
            <div class="c-filter-actions-bar">
                <div class="c-filter-actions-left"></div>
                <div class="c-filter-actions-right">
                    <button class="c-btn c-btn-ghost js-reset" type="button">清空</button>
                    <button class="c-btn c-btn-primary js-search" type="button">搜索</button>
                </div>
            </div>
        </section>

        <section class="c-card c-card-pad match-view hidden" data-view="cases">
            <h2 class="title c-panel-title">案件信息</h2>
            <div class="form-grid form-grid-single form-grid-spaced">
                <div class="form-field">
                    <label for="case-info">案件信息</label>
                    <textarea id="case-info" rows="10" placeholder="请输入案件信息。"></textarea>
                </div>
            </div>
            <div class="c-filter-actions-bar">
                <div class="c-filter-actions-left"></div>
                <div class="c-filter-actions-right">
                    <button class="c-btn c-btn-ghost js-reset" type="button">清空</button>
                    <button class="c-btn c-btn-primary js-search" type="button">搜索</button>
                </div>
            </div>
        </section>
        </div>

        <section class="c-card c-card-pad">
            <div class="c-stack">
                <div>
                    <h2 class="title c-panel-title" id="list-title">案件列表</h2>
                    <div class="filters c-filter-grid">
                        <div class="filter-group c-filter-group">
                            <span class="filter-label c-filter-label" data-i18n="qiuanjian.filter.time">时间</span>
                            <div class="chip-row c-chip-row">
                                <button class="chip c-chip active" data-range="all" type="button" data-i18n="qiuanjian.range.all">全部</button>
                                <button class="chip c-chip" data-range="today" type="button" data-i18n="qiuanjian.range.today">今天</button>
                                <button class="chip c-chip" data-range="yesterday" type="button" data-i18n="qiuanjian.range.yesterday">昨天</button>
                                <input id="date-picker" class="input c-input date-input" type="date" aria-label="选择日期" data-i18n-aria="qiuanjian.date.label">
                            </div>
                        </div>
                        <div class="filter-group c-filter-group">
                            <span class="filter-label c-filter-label" data-i18n="qiuanjian.filter.keyword">关键字</span>
                            <input id="keyword-input" class="input c-input" type="search" placeholder="搜索案件标题、描述或细节" data-i18n-placeholder="qiuanjian.keyword.placeholder">
                        </div>
                    </div>
                    <ul id="case-list" class="list c-list match-list">
                    </ul>
                </div>

                <div>
                    <h2 class="title c-panel-title" id="detail-title">案件详情</h2>
                    <div id="case-detail" class="detail">
                        这是案件1的详细说明……ABCDEFG1234567890不想超出屏幕会自动换行。
                    </div>
                </div>
            </div>
        </section>
        </div>
    </div>

    <script src="i18n.js"></script>
    <script>
        (function () {
            const i18n = window.I18N;
            const t = (key) => (i18n ? i18n.t(key) : key);
            const cases = [
                {
                    id: 1,
                    title: '案件1标题',
                    desc: '案件1的简单说明 content',
                    detail: '这是案件1的详细说明……ABCDEFG1234567890不想超出屏幕会自动换行。',
                    date: '2025-12-01'
                },
                {
                    id: 2,
                    title: '案件2标题',
                    desc: '案件2的简单说明 content',
                    detail: '这是案件2的详细说明……ABCDEFG1234567890不想超出屏幕会自动换行。',
                    date: '2025-11-25'
                },
                {
                    id: 3,
                    title: '案件3标题',
                    desc: '案件3的简单说明 content',
                    detail: '这是案件3的详细说明……ABCDEFG1234567890不想超出屏幕会自动换行。',
                    date: '2025-11-20'
                },
                {
                    id: 4,
                    title: '案件4标题',
                    desc: '案件4的简单说明 content',
                    detail: '这是案件4的详细说明……ABCDEFG1234567890不想超出屏幕会自动换行。',
                    date: '2025-11-18'
                },
                {
                    id: 5,
                    title: '案件5标题',
                    desc: '案件5的简单说明 content',
                    detail: '这是案件5的详细说明……ABCDEFG1234567890不想超出屏幕会自动换行。',
                    date: '2025-11-12'
                }
            ];

            const list = document.getElementById('case-list');
            const detail = document.getElementById('case-detail');
            const keywordInput = document.getElementById('keyword-input');
            const datePicker = document.getElementById('date-picker');
            const dateButtons = Array.from(document.querySelectorAll('.chip[data-range]'));
            const viewButtons = Array.from(document.querySelectorAll('.c-toggle[data-view]'));
            const views = Array.from(document.querySelectorAll('.match-view'));
            const resetButtons = Array.from(document.querySelectorAll('.js-reset'));
            const searchButtons = Array.from(document.querySelectorAll('.js-search'));
            const listTitle = document.getElementById('list-title');
            const detailTitle = document.getElementById('detail-title');
            const filters = {
                range: 'all',
                customDate: ''
            };
            const viewInputs = {
                people: ['nation', 'age', 'price', 'intro'],
                cases: ['case-info']
            };

            const getActiveView = () => {
                const active = document.querySelector('.match-view:not(.hidden)');
                return active ? active.dataset.view : 'people';
            };

            const setView = (view) => {
                views.forEach(section => {
                    section.classList.toggle('hidden', section.dataset.view !== view);
                });
                viewButtons.forEach(btn => {
                    const isActive = btn.dataset.view === view;
                    btn.classList.toggle('is-active', isActive);
                    btn.setAttribute('aria-selected', isActive ? 'true' : 'false');
                });
                if (listTitle) {
                    listTitle.textContent = view === 'cases' ? '技术者列表' : '案件列表';
                }
                if (detailTitle) {
                    detailTitle.textContent = view === 'cases' ? '技术者详情' : '案件详情';
                }
            };

            const formatDate = (date) => date.toISOString().slice(0, 10);

            const renderList = (items) => {
                list.innerHTML = '';

                if (!items.length) {
                    const empty = document.createElement('li');
                    empty.className = 'empty';
                    empty.textContent = t('qiuanjian.empty.list');
                    list.appendChild(empty);
                    detail.textContent = t('qiuanjian.empty.detail');
                    return;
                }

                items.forEach((item, index) => {
                    const li = document.createElement('li');
                    li.className = 'item' + (index === 0 ? ' active' : '');
                    li.dataset.detail = item.detail;
                    li.dataset.id = item.id;

                    const main = document.createElement('div');
                    main.className = 'item-main';

                    const title = document.createElement('div');
                    title.className = 'item-title';
                    title.textContent = item.title;

                    const desc = document.createElement('div');
                    desc.className = 'item-desc';
                    desc.textContent = item.desc;

                    const time = document.createElement('div');
                    time.className = 'item-time';
                    time.textContent = item.date;

                    main.appendChild(title);
                    main.appendChild(desc);
                    li.appendChild(main);
                    li.appendChild(time);
                    list.appendChild(li);
                });

                const first = list.querySelector('.item');
                if (first) {
                    detail.textContent = first.dataset.detail || '';
                }
            };

            const applyFilters = () => {
                const today = formatDate(new Date());
                const yesterdayDate = new Date();
                yesterdayDate.setDate(yesterdayDate.getDate() - 1);
                const yesterday = formatDate(yesterdayDate);

                const keyword = keywordInput.value.trim().toLowerCase();
                const targetDate = filters.range === 'today'
                    ? today
                    : filters.range === 'yesterday'
                        ? yesterday
                        : filters.range === 'custom'
                            ? filters.customDate
                            : '';

                const filtered = cases.filter(item => {
                    const matchKeyword = keyword
                        ? (item.title + item.desc + item.detail).toLowerCase().includes(keyword)
                        : true;
                    const matchDate = targetDate ? item.date === targetDate : true;
                    return matchKeyword && matchDate;
                });

                renderList(filtered);
            };

            list.addEventListener('click', (e) => {
                const item = e.target.closest('.item');
                if (!item) return;
                list.querySelectorAll('.item').forEach(li => li.classList.remove('active'));
                item.classList.add('active');
                detail.textContent = item.dataset.detail || '';
            });

            dateButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    dateButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    filters.range = btn.dataset.range;
                    filters.customDate = '';
                    datePicker.value = '';
                    datePicker.classList.remove('active');
                    applyFilters();
                });
            });

            datePicker.addEventListener('change', () => {
                if (datePicker.value) {
                    filters.range = 'custom';
                    filters.customDate = datePicker.value;
                    dateButtons.forEach(b => b.classList.remove('active'));
                    datePicker.classList.add('active');
                } else {
                    filters.range = 'all';
                    filters.customDate = '';
                    dateButtons.forEach(b => {
                        b.classList.toggle('active', b.dataset.range === 'all');
                    });
                    datePicker.classList.remove('active');
                }
                applyFilters();
            });

            keywordInput.addEventListener('input', () => {
                applyFilters();
            });

            resetButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const view = getActiveView();
                    const ids = viewInputs[view] || [];
                    const elements = ids.map(id => document.getElementById(id)).filter(Boolean);
                    elements.forEach(el => { el.value = ''; });
                    if (elements[0]) {
                        elements[0].focus();
                    }
                });
            });

            searchButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    alert('已搜索');
                });
            });

            viewButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    setView(btn.dataset.view);
                });
            });

            if (i18n) {
                i18n.init();
                i18n.apply();
            }
            setView(getActiveView());
            renderList(cases);
            if (window && window.addEventListener) {
                window.addEventListener("i18n:change", () => {
                    if (i18n) {
                        i18n.apply();
                    }
                    applyFilters();
                });
            }
        })();
    </script>
</body>
</html>
